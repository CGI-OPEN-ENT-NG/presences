<h1>
    <i18n>presences.register.register.title</i18n>
</h1>
<loader ng-show="vm.isLoading()"
        title="lang.translate('presences.register.loading.text')"
        min-height="'250px'"/>
<user-cards users="vm.register.teachers"
            workflow="presences.search"
            ng-model="vm.filter.selected.registerTeacher"
            notified="vm.register.notified"
            can-notify="vm.canNotify(vm.register.start_date, vm.register.state_id)"
            on-notify="::vm.notify"
            ng-change="vm.switchRegisterTeacher"
            ng-if="vm.register && vm.register.teachers"
            ng-show="!vm.register.loading && vm.register.teachers.length > 0">
</user-cards>
<div class="row register" ng-if="!vm.isLoading() && !vm.isEmptyGroupRegister()">
    <panel opened="vm.filter.student !== undefined">
        <container template="register-panel"></container>
    </panel>

    <div class="row vertical-spacing">
        <span data-ng-click="vm.previousDate()">
            <i class="left-open"></i>
        </span>
        <span class="card date-picker">
            <date-picker ng-model="vm.filter.date" ng-change="vm.changeDate()"></date-picker>
        </span>
        <span data-ng-click="vm.nextDate()">
            <i class="open-right"></i>
        </span>
    </div>
    <div class="row card-slider">
        <div class="card cell" ng-repeat="course in vm.courses.all|orderBy:'timestamp'"
             data-ng-click="vm.openRegister(course)"
             ng-class="{active: vm.isCurrentRegister(course), disabled: vm.isFuturCourse(course)}">
            <div class="row hour">[[::vm.formatHour(course.startDate)]] -
                [[::vm.formatHour(course.endDate)]]
            </div>
            <div class="row classes">
                <span ng-repeat="class in course.classes">[[::class]]</span>
                <span ng-repeat="group in course.groups">[[::group]]</span>
            </div>
            <div class="row subject ellipsis">[[::course.subjectName]]</div>
        </div>
    </div>
    <div class="row settings" ng-if="vm.register">
        <div class="cell view-settings" ng-if="vm.register.groupMap !== undefined">
            <i class="show-list"
               ng-click="template.open('register', 'register/list-view')"
               ng-class="{ active: template.contains('register', 'register/list-view') }"></i>
            <i class="split-view"
               ng-click="template.open('register', 'register/split-view')"
               ng-class="{ active: template.contains('register', 'register/split-view') }"></i>
        </div>
        <div class="card radius cell">
            <span class="cell horizontal-spacing vertical-spacing-twice" style="padding-right: 0;">
                <i18n>presences.registers.attenders</i18n> :
            </span>
            <div class="horizontal-spacing vertical-spacing-twice font-bold cell">
                [[vm.register.students.length - vm.register.absenceCounter]]
                /
                [[vm.register.students.length]]
            </div>
        </div>
        <div class="card event-legend radius cell horizontal-margin">
            <ul class="vertical-spacing-twice horizontal-margin">
                <li class="absence">
                    <i18n>presences.register.event_type.absences</i18n>
                </li>
                <li class="lateness">
                    <i18n>presences.register.event_type.lateness</i18n>
                </li>
                <li class="departure">
                    <i18n>presences.register.event_type.departure</i18n>
                </li>
                <li class="remark">
                    <i18n>presences.register.event_type.remark</i18n>
                </li>
                <li class="last-absent">
                    <i class="last-absent"></i>
                    <i18n>presences.register.event_type.last.absent</i18n>
                </li>
                <li class="forgotten-notebook">
                    <i class="forgotten-notebook"></i>
                    <i18n>presences.register.event_type.forgotten.notebook</i18n>
                </li>
            </ul>
        </div>
        <button class="right-magnet"
                data-ng-click="vm.validRegister()"
                ng-show="vm.register && !vm.register.loading">
            <i18n>presences.register.validation</i18n>
        </button>
    </div>
    <div class="row vertical-spacing-four" role="grid"
         ng-show="vm.register && !vm.register.loading">
        <container template="register"></container>
    </div>
    <!--    <button data-ng-click="vm.register.setStatus(vm.RegisterStatus.DONE)"-->
    <!--            ng-show="vm.register && !vm.register.loading">-->
    <!--        <i18n>presences.register.validation</i18n>-->
    <!--    </button>-->
    <button class=""
            data-ng-click="vm.validRegister()"
            ng-show="vm.register && !vm.register.loading">
        <i18n>presences.register.validation</i18n>
    </button>
</div>
<div class="row register" ng-if="!vm.isLoading() && vm.isEmptyGroupRegister()">
    <div class="nine empty-content">
        <div class="eight description">
            <span class="red-bar bar"></span>
            <i18n>presences.registers.group.empty</i18n>
            <span class="purple-bar bar"></span>
        </div>
        <img data-ng-src="/presences/public/img/registers_empty.svg" class="four">
    </div>
</div>